T-10 Step & ArrayIteration Resolvers
Goal â€“ Replace mutation-based isArray flag.

Files

scopeDsl/nodes/stepResolver.js

scopeDsl/nodes/arrayIterationResolver.js

tests/nodes/step.test.js

Update parser later (ticket T-12).

StepResolver

Field access for each ID/object in ctx.walk(node.parent).

Uses entitiesGateway.getComponentData.

Returns Set of direct field values (no flatten).

ArrayIterationResolver

Handles new node type ArrayIterationStep (to be emitted by parser).

Flattens arrays using helper flattenIntoSet (see T-11).

T-11 Shared Utility: flattenIntoSet & ErrorFactory
Files

scopeDsl/core/flattenIntoSet.js

scopeDsl/core/errorFactory.js

tests/core/flatten.test.js

tests/core/errorFactory.test.js

flattenIntoSet per plan.
errorFactory.unknown(kind,value) returns new ScopeDslError.
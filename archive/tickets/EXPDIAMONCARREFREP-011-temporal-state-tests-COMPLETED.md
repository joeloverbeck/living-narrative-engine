# EXPDIAMONCARREFREP-011: Add MonteCarloSimulator Temporal State Tests

## Summary
Add missing direct assertions for temporal-state context generation in `MonteCarloSimulator`. Existing temporal-state tests already cover persistence-style expressions and correlated deltas; this ticket focuses on validating context shape/ranges/keys via stored contexts rather than adding new fixed-state flows that do not exist in the current API.

## Assumptions Reassessed (from report/code)
- `MonteCarloSimulator` exposes `simulate(...)`, not `run(...)`, and does not accept a `fixedState` distribution.
- `previousMoodAxes` is passed through as raw mood axis values (range `[-100, 100]`), not normalized to `[-1, 1]` in the context.
- `previous` state is always generated by `RandomStateGenerator`; there is no “missing previous state” path to test.
- Temporal expression evaluation for increasing/decreasing deltas is already covered in `monteCarloSimulator.temporalState.test.js`.

## Files to Modify

| File | Action | Changes |
|------|--------|---------|
| `tests/unit/expressionDiagnostics/services/monteCarloSimulator.temporalState.test.js` | Modify | Add direct context assertions for temporal state values/keys and ranges |

## Out of Scope

- **DO NOT** modify any production code
- **DO NOT** modify other test files
- **DO NOT** add integration tests

## Acceptance Criteria

### Temporal Context Shape & Range
1. `previousEmotions` includes all emotion prototype keys and values stay within [0, 1].
2. `previousSexualStates` includes all sexual prototype keys and values stay within [0, 1].
3. `previousMoodAxes` exists in the context and uses raw axis values within [-100, 100].

### Context Capture
1. Tests must use `storeSamplesForSensitivity` to access stored contexts for assertions.
2. Tests follow existing mock setup patterns in `monteCarloSimulator.temporalState.test.js`.

### Invariants That Must Remain True
1. Tests use existing mocks and avoid production code changes.
2. No new public APIs or breaking changes.

## Verification Commands
```bash
npm run test:unit -- --testPathPattern="monteCarloSimulator.temporalState" --coverage
```

## Dependencies
- **Depends on**: None (can run independently)
- **Blocks**: None

## Status
Completed

## Outcome
- Updated the ticket assumptions to match the current `simulate(...)` API and raw `previousMoodAxes` range.
- Added direct context assertions for previous emotions/sexual states and mood axes ranges using stored contexts.
- No production code changes were needed.

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://example.com/schemas/location.schema.json",
  "title": "Location Entity Schema",
  "description": "Defines the structure for a Location entity in the adventure game platform. Locations are entities composed of components.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "id",
    "components"
  ],
  "properties": {
    "id": {
      "$ref": "./common.schema.json#/definitions/namespacedId",
      "description": "A unique identifier for this location entity (e.g., 'core:room_entry', 'story_alpha:cave_chamber_1'). Used for linking connections and references."
    },
    "components": {
      "type": "object",
      "description": "A container for the components that define this location's properties and behavior.",
      "additionalProperties": false,
      "required": [
        "Name",
        "Connections"
      ],
      "properties": {
        "Name": {
          "$ref": "common.schema.json#/definitions/NameComponent",
          "description": "Component defining the display name of the location."
        },
        "Description": {
          "$ref": "common.schema.json#/definitions/DescriptionComponent",
          "description": "Component defining the static, pre-written narrative description of the location."
        },
        "MetaDescription": {
          "$ref": "common.schema.json#/definitions/MetaDescriptionComponent",
          "description": "Component providing concise keywords for generating dynamic descriptions via an LLM (used in Phase 3+)."
        },
        "Connections": {
          "$ref": "#/definitions/ConnectionsComponent",
          "description": "Component defining the exits or links from this location by referencing Connection entities."
        }
      },
      "anyOf": [
        {
          "required": [
            "Description"
          ],
          "description": "Ensures that the location has at least a static description."
        },
        {
          "required": [
            "MetaDescription"
          ],
          "description": "Ensures that the location has at least a meta-description for AI generation."
        }
      ]
    }
  },
  "definitions": {
    "ConnectionsComponent": {
      "type": "object",
      "description": "Component defining the exits or links from this location by referencing Connection entities.",
      "additionalProperties": false,
      "required": [
        "connections"
      ],
      "properties": {
        "connections": {
          "type": "object",
          "description": "A map where keys are direction strings (e.g., 'north', 'enter door') and values are the namespaced IDs of the corresponding Connection entities.",
          "additionalProperties": {
            "$ref": "./common.schema.json#/definitions/namespacedId",
            "description": "The namespacedId of the Connection entity representing this exit."
          },
          "propertyNames": {
            "type": "string",
            "description": "The direction command used to traverse this connection (e.g., 'north', 'climb ladder')."
          },
          "examples": [
            {
              "north": "conn:roomA_to_roomB",
              "climb ladder": "conn:roomA_to_attic",
              "enter door": "conn:roomA_to_closet"
            }
          ]
        }
      }
    }
  }
}
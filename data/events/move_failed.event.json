{
  "$schema": "http://example.com/schemas/event-definition.schema.json",
  "id": "event:move_failed",
  "description": "Signals that a move attempt, after initial validation, has failed due to a subsequent check (e.g., blocked, locked, target missing).",
  "payloadSchema": {
    "type": "object",
    "properties": {
      "actorId": {
        "type": "string",
        "description": "The unique identifier of the entity whose move failed.",
        "$ref": "./common.schema.json#/definitions/namespacedId"
      },
      "direction": {
        "type": "string",
        "description": "The direction the entity attempted to move."
      },
      "previousLocationId": {
        "type": "string",
        "description": "The unique identifier of the location the entity was in.",
        "$ref": "./common.schema.json#/definitions/namespacedId"
      },
      "attemptedTargetLocationId": {
        "type": "string",
        "description": "The unique identifier of the location entity the entity tried to move to.",
        "$ref": "./common.schema.json#/definitions/namespacedId"
      },
      "reasonCode": {
        "type": "string",
        "description": "A code indicating why the move failed.",
        "enum": [
          "TARGET_LOCATION_NOT_FOUND",
          "DIRECTION_LOCKED",
          "DIRECTION_BLOCKED",
          "BLOCKER_NOT_FOUND",
          "MOVE_EXECUTION_ERROR",
          "MOVEMENT_EXECUTION_FAILED",
          "COORDINATOR_INTERNAL_ERROR"
        ]
      },
      "details": {
        "type": [
          "string",
          "null"
        ],
        "description": "A user-friendly or diagnostic description of the failure reason."
      },
      "blockerDisplayName": {
        "type": [
          "string",
          "null"
        ],
        "description": "The display name of the entity that blocked the movement, if applicable."
      },
      "blockerEntityId": {
        "description": "The unique identifier of the entity that blocked the movement, if applicable.",
        "$ref": "./common.schema.json#/definitions/nullableNamespacedId"
      }
    },
    "required": [
      "actorId",
      "direction",
      "previousLocationId",
      "attemptedTargetLocationId",
      "reasonCode",
      "details"
    ],
    "additionalProperties": false
  }
}
{
  "$schema": "schema://living-narrative-engine/component.schema.json",
  "id": "metabolism:metabolic_store",
  "description": "Tracks an entity's energy reserves, burn rate, and metabolic state. Represents the actor's current energy level and how quickly it is consumed.",
  "dataSchema": {
    "type": "object",
    "properties": {
      "current_energy": {
        "type": "number",
        "minimum": 0,
        "description": "Current energy level. Cannot be negative. May exceed max_energy in gluttonous state."
      },
      "max_energy": {
        "type": "number",
        "minimum": 0,
        "description": "Maximum energy capacity for this entity."
      },
      "base_burn_rate": {
        "type": "number",
        "exclusiveMinimum": 0,
        "description": "Resting energy expenditure per turn. Must be greater than 0."
      },
      "activity_multiplier": {
        "type": "number",
        "minimum": 0,
        "default": 1.0,
        "description": "Current activity's energy cost multiplier (1.0 = normal, <1.0 = reduced, >1.0 = increased)."
      },
      "last_update_turn": {
        "type": "integer",
        "minimum": 0,
        "default": 0,
        "description": "Turn number of the last energy update. Used to calculate energy burn between turns."
      },
      "buffer_storage": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "bulk": {
              "type": "number",
              "minimum": 0
            },
            "energy_content": {
              "type": "number",
              "minimum": 0
            }
          },
          "required": ["bulk", "energy_content"]
        },
        "default": [],
        "description": "Array of consumed items waiting to be metabolized. Each item has bulk and energy_content."
      },
      "buffer_capacity": {
        "type": "number",
        "minimum": 0,
        "description": "Maximum total bulk that can be stored in buffer_storage."
      }
    },
    "required": [
      "current_energy",
      "max_energy",
      "base_burn_rate",
      "buffer_storage",
      "buffer_capacity"
    ],
    "additionalProperties": false
  },
  "validationRules": {
    "generateValidator": true,
    "errorMessages": {
      "invalidEnum": "Invalid {propertyName}: {{value}}. Valid options: {{validValues}}",
      "missingRequired": "{PropertyLabel} is required",
      "invalidType": "Invalid type for {propertyName}: expected {{expected}}, got {{actual}}",
      "minimum": "{PropertyLabel} must be at least {{limit}}",
      "maximum": "{PropertyLabel} must be at most {{limit}}",
      "exclusiveMinimum": "{PropertyLabel} must be greater than {{limit}}"
    },
    "suggestions": {
      "enableSimilarity": true,
      "maxDistance": 3,
      "maxSuggestions": 3
    }
  }
}

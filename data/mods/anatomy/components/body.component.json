{
  "$schema": "schema://living-narrative-engine/component.schema.json",
  "id": "anatomy:body",
  "description": "Links an entity to an anatomy recipe and stores the generated body structure",
  "dataSchema": {
    "type": "object",
    "properties": {
      "recipeId": {
        "type": "string",
        "description": "The namespaced ID of the anatomy recipe to use for body generation",
        "pattern": "^[a-zA-Z][a-zA-Z0-9_]*:[a-zA-Z][a-zA-Z0-9_]*$"
      },
      "body": {
        "type": ["object", "null"],
        "description": "The generated anatomy structure, null until body is built",
        "properties": {
          "root": {
            "type": "string",
            "description": "Entity instance ID of the root body part"
          },
          "parts": {
            "type": "object",
            "description": "Map of part identifiers to entity instance IDs for easy access",
            "additionalProperties": {
              "type": "string"
            }
          },
          "slotToPartMappings": {
            "type": "object",
            "description": "Map of blueprint slot ids to generated part entity ids",
            "additionalProperties": {
              "type": "string"
            }
          },
          "descriptors": {
            "type": "object",
            "description": "Body-level descriptors that apply to the whole body",
            "properties": {
              "build": {
                "type": "string",
                "enum": [
                  "skinny",
                  "slim",
                  "lissom",
                  "toned",
                  "athletic",
                  "shapely",
                  "hourglass",
                  "thick",
                  "muscular",
                  "hulking",
                  "stocky",
                  "frail",
                  "gaunt",
                  "skeletal",
                  "atrophied",
                  "cadaverous",
                  "massive",
                  "willowy",
                  "barrel-chested",
                  "lanky"
                ]
              },
              "hairDensity": {
                "type": "string",
                "enum": [
                  "hairless",
                  "sparse",
                  "light",
                  "moderate",
                  "hairy",
                  "very-hairy",
                  "furred"
                ]
              },
              "density": {
                "type": "string",
                "description": "DEPRECATED: Use hairDensity instead",
                "enum": [
                  "hairless",
                  "sparse",
                  "light",
                  "moderate",
                  "hairy",
                  "very-hairy"
                ]
              },
              "composition": {
                "type": "string",
                "enum": [
                  "underweight",
                  "lean",
                  "average",
                  "soft",
                  "bumpy",
                  "chubby",
                  "overweight",
                  "obese",
                  "atrophied",
                  "emaciated",
                  "skeletal",
                  "malnourished",
                  "dehydrated",
                  "wasted",
                  "desiccated",
                  "bloated",
                  "rotting"
                ]
              },
              "skinColor": {
                "type": "string"
              },
              "smell": {
                "type": "string"
              },
              "height": {
                "type": "string",
                "enum": [
                  "microscopic",
                  "minuscule",
                  "tiny",
                  "petite",
                  "short",
                  "average",
                  "tall",
                  "very-tall",
                  "gigantic",
                  "colossal",
                  "titanic"
                ]
              }
            },
            "additionalProperties": false
          }
        },
        "required": ["root", "parts"],
        "additionalProperties": false
      }
    },
    "required": ["recipeId"],
    "additionalProperties": false
  },
  "validationRules": {
    "generateValidator": true,
    "errorMessages": {
      "invalidEnum": "Invalid body descriptor value: {{value}}. Valid options: {{validValues}}",
      "missingRequired": "Body descriptor is required",
      "invalidType": "Invalid type for body descriptor: expected {{expected}}, got {{actual}}"
    },
    "suggestions": {
      "enableSimilarity": true,
      "maxDistance": 3,
      "maxSuggestions": 3
    }
  }
}

{
  "$schema": "http://example.com/schemas/action.schema.json",
  "id": "clothing:equip",
  "description": "Equips a clothing item on an entity",
  "targetType": "entity",
  "verb": "equip",
  "validation": {
    "actor": {
      "type": "entity",
      "required": true,
      "conditions": [
        {
          "type": "hasComponent",
          "componentId": "core:actor"
        }
      ]
    },
    "target": {
      "type": "entity",
      "required": true,
      "conditions": [
        {
          "type": "hasComponent",
          "componentId": "clothing:wearable"
        }
      ]
    }
  },
  "operation": {
    "type": "sequence",
    "operations": [
      {
        "type": "log",
        "level": "info",
        "message": "{{actor.name}} attempts to equip {{target.name}}"
      },
      {
        "type": "validateClothingCompatibility",
        "actorId": "{{actor.instanceId}}",
        "clothingItemId": "{{target.instanceId}}"
      },
      {
        "type": "equipClothing",
        "actorId": "{{actor.instanceId}}",
        "clothingItemId": "{{target.instanceId}}",
        "options": {
          "validateCoverage": true,
          "conflictResolution": "auto_remove"
        }
      },
      {
        "type": "dispatchEvent",
        "eventType": "display_successful_action_result",
        "payload": {
          "message": "{{actor.name}} equipped {{target.name}}",
          "actorId": "{{actor.instanceId}}",
          "actionType": "equip"
        }
      }
    ]
  },
  "onFailure": {
    "type": "dispatchEvent",
    "eventType": "display_failed_action_result",
    "payload": {
      "message": "{{actor.name}} failed to equip {{target.name}}: {{error.message}}",
      "actorId": "{{actor.instanceId}}",
      "actionType": "equip"
    }
  },
  "displayName": "Equip",
  "icon": "equip",
  "conditions": [
    {
      "type": "targetHasComponent",
      "componentId": "clothing:wearable"
    },
    {
      "type": "not",
      "condition": {
        "type": "isClothingEquipped",
        "actorId": "{{actor.instanceId}}",
        "clothingItemId": "{{target.instanceId}}"
      }
    }
  ]
}

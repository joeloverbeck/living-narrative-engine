{
  "$schema": "http://example.com/schemas/action.schema.json",
  "id": "clothing:unequip",
  "description": "Unequips a clothing item from an entity",
  "targetType": "entity",
  "verb": "unequip",
  "validation": {
    "actor": {
      "type": "entity",
      "required": true,
      "conditions": [
        {
          "type": "hasComponent",
          "componentId": "core:actor"
        }
      ]
    },
    "target": {
      "type": "entity",
      "required": true,
      "conditions": [
        {
          "type": "hasComponent",
          "componentId": "clothing:wearable"
        }
      ]
    }
  },
  "operation": {
    "type": "sequence",
    "operations": [
      {
        "type": "log",
        "level": "info",
        "message": "{{actor.name}} attempts to unequip {{target.name}}"
      },
      {
        "type": "validateClothingEquipped",
        "actorId": "{{actor.instanceId}}",
        "clothingItemId": "{{target.instanceId}}"
      },
      {
        "type": "unequipClothing",
        "actorId": "{{actor.instanceId}}",
        "clothingItemId": "{{target.instanceId}}",
        "options": {
          "cascadeUnequip": false,
          "reason": "manual"
        }
      },
      {
        "type": "dispatchEvent",
        "eventType": "display_successful_action_result",
        "payload": {
          "message": "{{actor.name}} unequipped {{target.name}}",
          "actorId": "{{actor.instanceId}}",
          "actionType": "unequip"
        }
      }
    ]
  },
  "onFailure": {
    "type": "dispatchEvent",
    "eventType": "display_failed_action_result",
    "payload": {
      "message": "{{actor.name}} failed to unequip {{target.name}}: {{error.message}}",
      "actorId": "{{actor.instanceId}}",
      "actionType": "unequip"
    }
  },
  "displayName": "Unequip",
  "icon": "unequip",
  "conditions": [
    {
      "type": "targetHasComponent",
      "componentId": "clothing:wearable"
    },
    {
      "type": "isClothingEquipped",
      "actorId": "{{actor.instanceId}}",
      "clothingItemId": "{{target.instanceId}}"
    }
  ]
}

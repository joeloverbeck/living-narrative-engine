{
  "$schema": "schema://living-narrative-engine/event.schema.json",
  "id": "core:ui_state_changed",
  "description": "Signals when a UI controller changes its display state. Used by character builder controllers to track state transitions between empty, loading, results, and error states.",
  "payloadSchema": {
    "type": "object",
    "properties": {
      "controller": {
        "description": "The name of the controller that changed state",
        "type": "string",
        "minLength": 1
      },
      "previousState": {
        "description": "The previous state (null for initial state change)",
        "oneOf": [
          {
            "type": "string",
            "enum": ["empty", "loading", "results", "error"]
          },
          {
            "type": "null"
          }
        ]
      },
      "currentState": {
        "description": "The new current state",
        "type": "string",
        "enum": ["empty", "loading", "results", "error"]
      },
      "timestamp": {
        "description": "ISO 8601 timestamp of when the state change occurred",
        "type": "string",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$"
      }
    },
    "required": ["controller", "currentState", "timestamp"],
    "additionalProperties": false
  }
}

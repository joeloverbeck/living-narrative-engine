{
  "$schema": "schema://living-narrative-engine/component.schema.json",
  "id": "core:player_turn_prompt",
  "description": "Fired when the game engine needs input from a player entity for their turn.",
  "payloadSchema": {
    "title": "Core: Player Turn Prompt â€“ Payload",
    "description": "List of actions the player can currently take, already formatted for UI/LLM consumption.",
    "type": "object",
    "properties": {
      "entityId": {
        "$ref": "schema://living-narrative-engine/common.schema.json#/definitions/namespacedId",
        "description": "ID of the actor whose turn it is."
      },
      "availableActions": {
        "type": "array",
        "description": "Every legal action for this turn, indexed so the UI (or an LLM) can choose by number.",
        "items": {
          "type": "object",
          "properties": {
            "index": {
              "type": "integer",
              "minimum": 1,
              "description": "Stable numeric choice presented to the player / LLM."
            },
            "actionId": {
              "$ref": "schema://living-narrative-engine/common.schema.json#/definitions/namespacedId",
              "description": "The underlying action definition ID (e.g. 'core:example_action' or 'mod_name:action_name')."
            },
            "commandString": {
              "type": "string",
              "description": "Fully-formatted command, ready for display or parsing."
            },
            "params": {
              "type": "object",
              "description": "Action-specific parameters (direction, targetId, etc.).",
              "additionalProperties": true,
              "default": {}
            },
            "description": {
              "type": "string",
              "description": "Human-readable explanation of the action."
            },
            "visual": {
              "type": ["object", "null"],
              "description": "Visual customization properties for action buttons, or null if not defined.",
              "properties": {
                "backgroundColor": {
                  "type": "string",
                  "description": "CSS color value for button background"
                },
                "textColor": {
                  "type": "string",
                  "description": "CSS color value for button text"
                },
                "hoverBackgroundColor": {
                  "type": "string",
                  "description": "CSS color for button hover state background"
                },
                "hoverTextColor": {
                  "type": "string",
                  "description": "CSS color for button hover state text"
                }
              },
              "additionalProperties": false
            }
          },
          "required": ["index", "actionId", "commandString", "description"],
          "additionalProperties": false
        },
        "uniqueItems": true
      },
      "suggestedAction": {
        "type": "object",
        "description": "Optional preselection metadata for UI, typically from an LLM suggestion.",
        "properties": {
          "index": {
            "type": ["integer", "null"],
            "minimum": 1,
            "description": "Suggested choice index (clamped to available actions)."
          },
          "descriptor": {
            "type": ["string", "null"],
            "description": "Human-readable description of the suggested action."
          }
        },
        "additionalProperties": false
      }
    },
    "required": ["entityId", "availableActions"],
    "additionalProperties": false
  }
}

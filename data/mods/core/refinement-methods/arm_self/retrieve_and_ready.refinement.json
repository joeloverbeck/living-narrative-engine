{
  "$schema": "schema://living-narrative-engine/refinement-method.schema.json",
  "id": "core:arm_self.retrieve_and_ready",
  "taskId": "core:arm_self",
  "description": "Collect the known weapon from the environment before readying it.",
  "applicability": {
    "description": "Actor is not already carrying the target.",
    "condition": {
      "or": [
        { "!": { "var": "actor.components.items:inventory" } },
        {
          "!": {
            "and": [
              { "!!": { "var": "actor.components.items:inventory" } },
              {
                "in": [
                  { "var": "task.params.target" },
                  { "var": "actor.components.items:inventory.items" }
                ]
              }
            ]
          }
        }
      ]
    }
  },
  "steps": [
    {
      "stepType": "primitive_action",
      "description": "Pick up the weapon from the current location.",
      "actionId": "items:pick_up_item",
      "targetBindings": {
        "item": "task.params.target"
      }
    },
    {
      "stepType": "primitive_action",
      "description": "Inspect the weapon to finish arming.",
      "actionId": "items:examine_owned_item",
      "targetBindings": {
        "target": "task.params.target"
      }
    }
  ],
  "fallbackBehavior": "replan"
}

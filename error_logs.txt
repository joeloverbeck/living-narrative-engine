Error
Error
System error in ProcessingCommandState for actor isekai:hero_instance: ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProc…

Show more
Developer details
{
  "raw": "OriginalError: Error - ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function.",
  "stack": "Error: ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function.\n    at getServiceFromContext (http://127.0.0.1:8080/bundle.js:57624:28)\n    at CommandProcessingWorkflow._dispatchAction (http://127.0.0.1:8080/bundle.js:57655:38)\n    at CommandProcessingWorkflow.processCommand (http://127.0.0.1:8080/bundle.js:57788:43)\n    at ProcessingCommandState._processCommandInternal (http://127.0.0.1:8080/bundle.js:58549:22)\n    at ProcessingWorkflow._executeAction (http://127.0.0.1:8080/bundle.js:58044:27)\n    at ProcessingWorkflow.run (http://127.0.0.1:8080/bundle.js:57900:18)\n    at async ProcessingCommandState.enterState (http://127.0.0.1:8080/bundle.js:58488:7)\n    at async ActorTurnHandler._transitionToState (http://127.0.0.1:8080/bundle.js:48237:9)\n    at async ActorTurnHandler.requestProcessingCommandStateTransition (http://127.0.0.1:8080/bundle.js:48526:7)\n    at async _TurnContext.requestProcessingCommandStateTransition (http://127.0.0.1:8080/bundle.js:56147:7)",
  "timestamp": "2025-06-26T14:43:20.071Z"
}


----

SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 1/3] About to execute operation of type: GET_TIMESTAMP
consoleLogger.js:187 OperationInterpreter: Executing handler for operation type "GET_TIMESTAMP"…
consoleLogger.js:187 SystemLogicInterpreter: GET_TIMESTAMP → currentTimestamp = 2025-06-26T14:43:20.063Z
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 1/3] Finished executing operation of type: GET_TIMESTAMP
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 2/3] About to execute operation of type: DISPATCH_PERCEPTIBLE_EVENT
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {context.speakerPositionComponent.locationId} to: isekai:adventurers_guild_instance
consoleLogger.js:187 OperationInterpreter: Replaced embedded placeholder {context.speakerNameComponent.text} with string: "Joel Overberus"
consoleLogger.js:187 OperationInterpreter: Replaced embedded placeholder {event.payload.speechContent} with string: "test speech!"
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.entityId} to: isekai:hero_instance
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.speechContent} to: test speech!
consoleLogger.js:187 OperationInterpreter: Executing handler for operation type "DISPATCH_PERCEPTIBLE_EVENT"…
consoleLogger.js:187 DISPATCH_PERCEPTIBLE_EVENT: dispatching event {payload: {…}}
consoleLogger.js:187 VED: Validating payload for event 'core:perceptible_event' against schema 'core:perceptible_event#payload'...
consoleLogger.js:187 VED: Payload validation SUCCEEDED for event 'core:perceptible_event'.
consoleLogger.js:187 VED: Dispatching event 'core:perceptible_event' via EventBus... {eventName: 'core:perceptible_event', locationId: 'isekai:adventurers_guild_instance', descriptionText: 'Joel Overberus says: "test speech!"', timestamp: '2025-06-26T14:43:20.064Z', perceptionType: 'speech_local', …}
consoleLogger.js:187 SystemLogicInterpreter: Received event: core:perceptible_event. Found 1 potential rule(s). {payload: {…}}
consoleLogger.js:187 SystemLogicInterpreter: [Event: core:perceptible_event] Assembling execution context via createNestedExecutionContext... (ActorID: isekai:hero_instance, TargetID: null)
consoleLogger.js:187 SystemLogicInterpreter: createJsonLogicContext: Creating JsonLogicEvaluationContext for event type [core:perceptible_event]. ActorID: [isekai:hero_instance], TargetID: [None]
consoleLogger.js:187 SystemLogicInterpreter: createJsonLogicContext: Found actor entity [isekai:hero_instance]. Creating context entry.
consoleLogger.js:187 SystemLogicInterpreter: createJsonLogicContext: No targetId provided, target context remains null.
consoleLogger.js:187 SystemLogicInterpreter: [Event: core:perceptible_event] createNestedExecutionContext returned a valid ExecutionContext.
consoleLogger.js:187 SystemLogicInterpreter: [Event: core:perceptible_event] Final ExecutionContext (nested structure) assembled successfully.
consoleLogger.js:187 SystemLogicInterpreter: [Rule log_perceptible_events] No condition defined or condition is empty. Defaulting to passed.
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'log_perceptible_events' - Action 1/2] About to execute operation of type: SET_VARIABLE
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.descriptionText} to: Joel Overberus says: "test speech!"
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.timestamp} to: 2025-06-26T14:43:20.064Z
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.perceptionType} to: speech_local
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.actorId} to: isekai:hero_instance
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.targetId} to: null
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.involvedEntities} to: []
consoleLogger.js:187 OperationInterpreter: Executing handler for operation type "SET_VARIABLE"…
consoleLogger.js:187 SetVariableHandler initialized.
consoleLogger.js:187 SET_VARIABLE: Value for "logEntryData" is a non-empty object. Attempting JsonLogic evaluation using executionContext.evaluationContext as data source.
consoleLogger.js:187 SET_VARIABLE: JsonLogic evaluation successful for "logEntryData". Result: {"descriptionText":"Joel Overberus says: \"test speech!\"","timestamp":"2025-06-26T14:43:20.064Z","perceptionType":"speech_local","actorId":"isekai:hero_instance","targetId":null,"involvedEntities":[]}
consoleLogger.js:187 SET_VARIABLE: Setting context variable "logEntryData" in evaluationContext.context to value: {"descriptionText":"Joel Overberus says: \"test speech!\"","timestamp":"2025-06-26T14:43:20.064Z","perceptionType":"speech_local","actorId":"isekai:hero_instance","targetId":null,"involvedEntities":[]}
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'log_perceptible_events' - Action 1/2] Finished executing operation of type: SET_VARIABLE
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'log_perceptible_events' - Action 2/2] About to execute operation of type: ADD_PERCEPTION_LOG_ENTRY
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.locationId} to: isekai:adventurers_guild_instance
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.descriptionText} to: Joel Overberus says: "test speech!"
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.timestamp} to: 2025-06-26T14:43:20.064Z
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.perceptionType} to: speech_local
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.actorId} to: isekai:hero_instance
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.targetId} to: null
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.involvedEntities} to: []
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.actorId} to: isekai:hero_instance
consoleLogger.js:187 OperationInterpreter: Executing handler for operation type "ADD_PERCEPTION_LOG_ENTRY"…
consoleLogger.js:187 VED: Validating payload for event 'core:component_added' against schema 'core:component_added#payload'...
consoleLogger.js:187 VED: Payload validation SUCCEEDED for event 'core:component_added'.
consoleLogger.js:187 VED: Dispatching event 'core:component_added' via EventBus... {entity: Entity, componentTypeId: 'core:perception_log', componentData: {…}, oldComponentData: {…}}
consoleLogger.js:187 Successfully added/updated component 'core:perception_log' data on entity 'isekai:hero_instance'.
consoleLogger.js:187 VED: Validating payload for event 'core:component_added' against schema 'core:component_added#payload'...
consoleLogger.js:187 VED: Payload validation SUCCEEDED for event 'core:component_added'.
consoleLogger.js:187 VED: Dispatching event 'core:component_added' via EventBus... {entity: Entity, componentTypeId: 'core:perception_log', componentData: {…}, oldComponentData: {…}}
consoleLogger.js:187 Successfully added/updated component 'core:perception_log' data on entity 'isekai:ninja_instance'.
consoleLogger.js:187 SystemLogicInterpreter: ADD_PERCEPTION_LOG_ENTRY: wrote entry to 2/2 perceivers in isekai:adventurers_guild_instance
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'log_perceptible_events' - Action 2/2] Finished executing operation of type: ADD_PERCEPTION_LOG_ENTRY
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 2/3] Finished executing operation of type: DISPATCH_PERCEPTIBLE_EVENT
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 3/3] About to execute operation of type: DISPATCH_SPEECH
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.entityId} to: isekai:hero_instance
consoleLogger.js:187 OperationInterpreter: Resolved full string placeholder {event.payload.speechContent} to: test speech!
consoleLogger.js:187 OperationInterpreter: Executing handler for operation type "DISPATCH_SPEECH"…
consoleLogger.js:187 SystemLogicInterpreter: DISPATCH_SPEECH: dispatching display_speech {payload: {…}}
consoleLogger.js:187 VED: Validating payload for event 'core:display_speech' against schema 'core:display_speech#payload'...
consoleLogger.js:187 VED: Payload validation SUCCEEDED for event 'core:display_speech'.
consoleLogger.js:187 VED: Dispatching event 'core:display_speech' via EventBus... {entityId: 'isekai:hero_instance', speechContent: 'test speech!', allowHtml: false}
consoleLogger.js:187 [EntityDisplayDataProvider] getEntityPortraitPath: Constructed portrait path for 'isekai:hero_instance': /data/mods/isekai/portraits/hero.png
consoleLogger.js:187 [SpeechBubbleRenderer] Added DOM listener for 'load' on element. {elementPath: 'img.speech-portrait'}
consoleLogger.js:187 [SpeechBubbleRenderer] Added DOM listener for 'error' on element. {elementPath: 'img.speech-portrait'}
consoleLogger.js:187 [SpeechBubbleRenderer] Rendered speech for Joel Overberus (Player).
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' IF#2 - Action 3/3] Finished executing operation of type: DISPATCH_SPEECH
consoleLogger.js:187 SystemLogicInterpreter: [Rule 'entity_speech' - Action 2/2] Finished executing IF operation.
2consoleLogger.js:187 VED: Event 'core:component_added' dispatch successful.
consoleLogger.js:187 VED: Event 'core:perceptible_event' dispatch successful.
consoleLogger.js:187 VED: Event 'core:display_speech' dispatch successful.
consoleLogger.js:187 VED: Event 'core:entity_spoke' dispatch successful.
2consoleLogger.js:187 SafeEventDispatcher: Successfully dispatched event 'core:component_added'.
consoleLogger.js:187 SafeEventDispatcher: Successfully dispatched event 'core:perceptible_event'.
consoleLogger.js:187 SafeEventDispatcher: Successfully dispatched event 'core:entity_spoke'.
consoleLogger.js:187 ProcessingCommandState: Attempted dispatch of core:entity_spoke for actor isekai:hero_instance via TurnContext's SafeEventDispatcher. {payload: {…}}
consoleLogger.js:175 ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function.
    at getServiceFromContext (getServiceFromContext.js:76:13)
    at CommandProcessingWorkflow._dispatchAction (commandProcessingWorkflow.js:51:36)
    at CommandProcessingWorkflow.processCommand (commandProcessingWorkflow.js:213:41)
    at ProcessingCommandState._processCommandInternal (processingCommandState.js:211:20)
    at ProcessingWorkflow._executeAction (processingWorkflow.js:255:25)
    at ProcessingWorkflow.run (processingWorkflow.js:87:16)
    at async ProcessingCommandState.enterState (processingCommandState.js:145:5)
    at async ActorTurnHandler._transitionToState (baseTurnHandler.js:233:7)
    at async ActorTurnHandler.requestProcessingCommandStateTransition (baseTurnHandler.js:606:5)
    at async _TurnContext.requestProcessingCommandStateTransition (turnContext.js:253:5)
error @ consoleLogger.js:175
getServiceFromContext @ getServiceFromContext.js:89
_dispatchAction @ commandProcessingWorkflow.js:51
processCommand @ commandProcessingWorkflow.js:213
_processCommandInternal @ processingCommandState.js:211
_executeAction @ processingWorkflow.js:255
run @ processingWorkflow.js:87
await in run
enterState @ processingCommandState.js:145
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestProcessingCommandStateTransition @ baseTurnHandler.js:606
requestProcessingCommandStateTransition @ turnContext.js:253
run @ actionDecisionWorkflow.js:56
await in run
_handleActionDecision @ awaitingActorDecisionState.js:86
enterState @ awaitingActorDecisionState.js:103
await in enterState
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestAwaitingInputStateTransition @ baseTurnHandler.js:591
requestAwaitingInputStateTransition @ turnContext.js:249
_requestAwaitingInput @ turnIdleState.js:139
startTurn @ turnIdleState.js:71
startTurn @ genericTurnHandler.js:134
startTurn @ actorTurnHandler.js:64
advanceTurn @ turnManager.js:424
await in advanceTurn
advanceTurn @ turnManager.js:325
await in advanceTurn
start @ turnManager.js:189
_finalizeGameStart @ gameSessionManager.js:142
await in _finalizeGameStart
finalizeNewGameSuccess @ gameSessionManager.js:163
startNewGame @ gameEngine.js:199
await in startNewGame
startGameStage @ engineStages.js:87
beginGame @ main.js:217
(anonymous) @ game.html:314
Promise.then
(anonymous) @ game.html:311Understand this error
consoleLogger.js:187 VED: Validating payload for event 'core:system_error_occurred' against schema 'core:system_error_occurred#payload'...
consoleLogger.js:175 VED: Payload validation FAILED for event 'core:system_error_occurred'. Dispatch SKIPPED. Errors: [/details]: must NOT have additional properties; [/details]: must NOT have additional properties; [/details]: must NOT have additional properties; [/details]: must NOT have additional properties {payload: {…}, errors: Array(4)}
error @ consoleLogger.js:175
dispatch @ validatedEventDispatcher.js:109
dispatch @ safeEventDispatcher.js:92
safeDispatchError @ safeDispatchErrorUtils.js:55
getServiceFromContext @ getServiceFromContext.js:91
_dispatchAction @ commandProcessingWorkflow.js:51
processCommand @ commandProcessingWorkflow.js:213
_processCommandInternal @ processingCommandState.js:211
_executeAction @ processingWorkflow.js:255
run @ processingWorkflow.js:87
await in run
enterState @ processingCommandState.js:145
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestProcessingCommandStateTransition @ baseTurnHandler.js:606
requestProcessingCommandStateTransition @ turnContext.js:253
run @ actionDecisionWorkflow.js:56
await in run
_handleActionDecision @ awaitingActorDecisionState.js:86
enterState @ awaitingActorDecisionState.js:103
await in enterState
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestAwaitingInputStateTransition @ baseTurnHandler.js:591
requestAwaitingInputStateTransition @ turnContext.js:249
_requestAwaitingInput @ turnIdleState.js:139
startTurn @ turnIdleState.js:71
startTurn @ genericTurnHandler.js:134
startTurn @ actorTurnHandler.js:64
advanceTurn @ turnManager.js:424
await in advanceTurn
advanceTurn @ turnManager.js:325
await in advanceTurn
start @ turnManager.js:189
_finalizeGameStart @ gameSessionManager.js:142
await in _finalizeGameStart
finalizeNewGameSuccess @ gameSessionManager.js:163
startNewGame @ gameEngine.js:199
await in startNewGame
startGameStage @ engineStages.js:87
beginGame @ main.js:217
(anonymous) @ game.html:314
Promise.then
(anonymous) @ game.html:311Understand this error
consoleLogger.js:187 VED: Dispatch skipped for 'core:system_error_occurred' due to validation failure (see error above).
consoleLogger.js:175 ProcessingCommandState: Error during command processing for actor isekai:hero_instance (wasProcessing: true): ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function. Error: ProcessingCommandState: Failed to retrieve ICommandProcessor for actor isekai:hero_instance. Error: Method turnCtx.getCommandProcessor() does not exist or is not a function.
    at getServiceFromContext (getServiceFromContext.js:104:26)
    at CommandProcessingWorkflow._dispatchAction (commandProcessingWorkflow.js:51:36)
    at CommandProcessingWorkflow.processCommand (commandProcessingWorkflow.js:213:41)
    at ProcessingCommandState._processCommandInternal (processingCommandState.js:211:20)
    at ProcessingWorkflow._executeAction (processingWorkflow.js:255:25)
    at ProcessingWorkflow.run (processingWorkflow.js:87:16)
    at async ProcessingCommandState.enterState (processingCommandState.js:145:5)
    at async ActorTurnHandler._transitionToState (baseTurnHandler.js:233:7)
    at async ActorTurnHandler.requestProcessingCommandStateTransition (baseTurnHandler.js:606:5)
    at async _TurnContext.requestProcessingCommandStateTransition (turnContext.js:253:5)
error @ consoleLogger.js:175
logAndDispatch @ processingExceptionHandler.js:75
handle @ processingExceptionHandler.js:53
getServiceFromContext @ getServiceFromContext.js:106
_dispatchAction @ commandProcessingWorkflow.js:51
processCommand @ commandProcessingWorkflow.js:213
_processCommandInternal @ processingCommandState.js:211
_executeAction @ processingWorkflow.js:255
run @ processingWorkflow.js:87
await in run
enterState @ processingCommandState.js:145
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestProcessingCommandStateTransition @ baseTurnHandler.js:606
requestProcessingCommandStateTransition @ turnContext.js:253
run @ actionDecisionWorkflow.js:56
await in run
_handleActionDecision @ awaitingActorDecisionState.js:86
enterState @ awaitingActorDecisionState.js:103
await in enterState
_transitionToState @ baseTurnHandler.js:233
await in _transitionToState
requestAwaitingInputStateTransition @ baseTurnHandler.js:591
requestAwaitingInputStateTransition @ turnContext.js:249
_requestAwaitingInput @ turnIdleState.js:139
startTurn @ turnIdleState.js:71
startTurn @ genericTurnHandler.js:134
startTurn @ actorTurnHandler.js:64
advanceTurn @ turnManager.js:424
await in advanceTurn
advanceTurn @ turnManager.js:325
await in advanceTurn
start @ turnManager.js:189
_finalizeGameStart @ gameSessionManager.js:142
await in _finalizeGameStart
finalizeNewGameSuccess @ gameSessionManager.js:163
startNewGame @ gameEngine.js:199
await in startNewGame
startGameStage @ engineStages.js:87
beginGame @ main.js:217
(anonymous) @ game.html:314
Promise.then
(anonymous) @ game.html:311Understand this error
consoleLogger.js:187 VED: Validating payload for event 'core:system_error_occurred' against schema 'core:system_error_occurred#payload'...
consoleLogger.js:187 VED: Payload validation SUCCEEDED for event 'core:system_error_occurred'.
consoleLogger.js:187 VED: Dispatching event 
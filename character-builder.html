<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Character Builder - Living Narrative Engine</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/character-builder.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  </head>
  <body>
    <div id="character-builder-container">
      <!-- Header -->
      <header class="character-builder-header">
        <div class="header-content">
          <h1>Character Builder</h1>
          <nav
            class="breadcrumb"
            role="navigation"
            aria-label="Character builder steps"
          >
            <span class="step active" aria-current="step"
              >Step 1: Thematic Directions</span
            >
            <span class="step disabled">Step 2: Clich√© Analysis</span>
            <span class="step disabled">Step 3: Core Motivations</span>
            <span class="step disabled">Step 4: Character Details</span>
            <span class="step disabled">Step 5: Final Polish</span>
          </nav>
        </div>
      </header>

      <!-- Main Content Area -->
      <main class="character-builder-main">
        <!-- Left Panel: Concept Input -->
        <section class="concept-input-panel">
          <h2>Character Concept</h2>
          <form id="character-concept-form" novalidate>
            <div class="input-group">
              <label for="character-concept-input">
                Describe your character concept:
                <span class="required" aria-hidden="true">*</span>
              </label>
              <textarea
                id="character-concept-input"
                name="characterConcept"
                placeholder="e.g. a ditzy female adventurer who's good with a bow"
                rows="4"
                minlength="10"
                maxlength="1000"
                required
                aria-describedby="concept-help concept-error"
              ></textarea>
              <div id="concept-help" class="input-help">
                Describe your character in a few sentences. Focus on
                personality, background, and key traits.
              </div>
              <div class="input-meta">
                <span class="char-count">0/1000</span>
                <div
                  id="concept-error"
                  class="error-message"
                  role="alert"
                  aria-live="polite"
                ></div>
              </div>
            </div>

            <div class="action-buttons">
              <button
                type="submit"
                id="generate-directions-btn"
                class="primary-button"
                disabled
              >
                <span class="button-text">Generate Thematic Directions</span>
                <span class="button-loading" style="display: none">
                  <span class="spinner"></span>
                  Generating...
                </span>
              </button>
              <button
                type="button"
                id="save-concept-btn"
                class="secondary-button"
                disabled
              >
                Save Concept
              </button>
            </div>
          </form>
        </section>

        <!-- Right Panel: Results Display -->
        <section class="thematic-directions-panel">
          <h2>Thematic Directions</h2>
          <div id="directions-container">
            <!-- Loading State -->
            <div
              id="loading-state"
              class="loading-state"
              style="display: none"
              aria-live="polite"
            >
              <div class="spinner large"></div>
              <p>Generating thematic directions...</p>
              <p class="loading-detail">
                This may take a moment while our AI analyzes your character
                concept.
              </p>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state">
              <div class="empty-icon" aria-hidden="true">üí°</div>
              <h3>Ready to Explore Your Character</h3>
              <p>
                Enter a character concept to generate thematic directions that
                will help you discover the deeper narrative potential of your
                character.
              </p>
            </div>

            <!-- Error State -->
            <div
              id="error-state"
              class="error-state"
              style="display: none"
              role="alert"
            >
              <div class="error-icon" aria-hidden="true">‚ö†Ô∏è</div>
              <h3>Generation Failed</h3>
              <p class="error-message">
                Failed to generate thematic directions. Please try again.
              </p>
              <div class="error-actions">
                <button type="button" id="retry-btn" class="secondary-button">
                  Try Again
                </button>
                <button
                  type="button"
                  id="error-details-btn"
                  class="tertiary-button"
                >
                  Show Details
                </button>
              </div>
              <div
                id="error-details"
                class="error-details"
                style="display: none"
              >
                <pre id="error-details-content"></pre>
              </div>
            </div>

            <!-- Results Display -->
            <div
              id="directions-results"
              class="directions-results"
              style="display: none"
            >
              <div class="results-header">
                <h3>Your Character's Thematic Directions</h3>
                <p class="results-description">
                  Explore these narrative possibilities for your character:
                </p>
              </div>
              <div id="directions-list" class="directions-list">
                <!-- Dynamic content populated by JavaScript -->
              </div>
              <div class="results-actions">
                <button
                  type="button"
                  id="regenerate-btn"
                  class="secondary-button"
                >
                  Generate New Directions
                </button>
                <button
                  type="button"
                  id="export-directions-btn"
                  class="secondary-button"
                >
                  Export as JSON
                </button>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Footer -->
      <footer class="character-builder-footer">
        <div class="navigation-buttons">
          <button type="button" id="back-to-menu-btn" class="secondary-button">
            ‚Üê Back to Main Menu
          </button>
          <button
            type="button"
            id="continue-step2-btn"
            class="primary-button"
            disabled
          >
            Continue to Step 2 ‚Üí
          </button>
        </div>

        <div class="footer-info">
          <p>Living Narrative Engine - Character Builder Step 1</p>
          <p class="help-text">
            Need help?
            <a href="#" id="help-link">View Character Building Guide</a>
          </p>
        </div>
      </footer>
    </div>

    <!-- Saved Concepts Sidebar -->
    <aside id="saved-concepts-sidebar" class="sidebar collapsed">
      <div class="sidebar-header">
        <h3>Saved Concepts</h3>
        <button
          type="button"
          id="toggle-sidebar-btn"
          class="toggle-button"
          aria-expanded="false"
          aria-controls="saved-concepts-content"
        >
          <span class="sr-only">Toggle saved concepts</span>
          <span class="toggle-icon">‚â°</span>
        </button>
      </div>
      <div id="saved-concepts-content" class="sidebar-content">
        <div class="sidebar-actions">
          <button
            type="button"
            id="refresh-concepts-btn"
            class="tertiary-button"
          >
            <span>üîÑ</span> Refresh
          </button>
          <button
            type="button"
            id="clear-all-concepts-btn"
            class="tertiary-button danger"
          >
            <span>üóëÔ∏è</span> Clear All
          </button>
        </div>
        <div id="saved-concepts-list" class="concepts-list">
          <div class="concepts-loading">
            <div class="spinner small"></div>
            <span>Loading concepts...</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Accessibility -->
    <div class="sr-only" id="live-region" aria-live="polite"></div>

    <!-- Modals -->
    <div
      id="help-modal"
      class="modal"
      style="display: none"
      role="dialog"
      aria-labelledby="help-title"
      aria-modal="true"
    >
      <div class="modal-overlay">
        <div class="modal-content">
          <div class="modal-header">
            <h2 id="help-title">Character Building Guide</h2>
            <button type="button" class="modal-close" aria-label="Close help">
              √ó
            </button>
          </div>
          <div class="modal-body">
            <h3>Step 1: Thematic Directions</h3>
            <p>
              In this step, you'll explore the deeper narrative potential of
              your character concept:
            </p>
            <ul>
              <li>
                <strong>Describe your character</strong> in a few sentences,
                focusing on personality, background, and key traits
              </li>
              <li>
                <strong>Generate directions</strong> to discover unique thematic
                possibilities
              </li>
              <li>
                <strong>Review the results</strong> to see different narrative
                paths your character could take
              </li>
            </ul>
            <h4>Tips for Better Results:</h4>
            <ul>
              <li>
                Include personality traits, not just physical descriptions
              </li>
              <li>Mention the character's background or situation</li>
              <li>Focus on what makes them unique or interesting</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div
      id="confirm-modal"
      class="modal"
      style="display: none"
      role="dialog"
      aria-labelledby="confirm-title"
      aria-modal="true"
    >
      <div class="modal-overlay">
        <div class="modal-content">
          <div class="modal-header">
            <h2 id="confirm-title">Confirm Action</h2>
            <button type="button" class="modal-close" aria-label="Close">
              √ó
            </button>
          </div>
          <div class="modal-body">
            <p id="confirm-message">
              Are you sure you want to perform this action?
            </p>
          </div>
          <div class="modal-footer">
            <button type="button" id="confirm-yes" class="primary-button">
              Yes
            </button>
            <button type="button" id="confirm-no" class="secondary-button">
              No
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Character Builder Scripts -->
    <script src="character-builder.js"></script>
  </body>
</html>
